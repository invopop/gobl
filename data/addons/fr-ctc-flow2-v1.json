{
  "$schema": "https://gobl.org/draft-0/tax/addon-def",
  "key": "fr-ctc-flow2-v1",
  "requires": [
    "eu-en16931-v2017"
  ],
  "name": {
    "en": "France CTC Flow 2",
    "fr": "France CTC Flux 2"
  },
  "description": {
    "en": "Support for the French CTC (Continuous Transaction Controls) Flow 2 B2B\ne-invoicing mandate from the French electronic invoicing reform.\n\nThis addon extends the EN 16931 European standard with French-specific rules for\nregulated B2B invoices, that is, invoices exchanged between two parties registered\nfor VAT in France. It should not be used for invoices that are subject only to\ne-reporting (for example, B2C or cross-border transactions).\n\n## Billing Mode\n\nEvery invoice must carry a **billing mode** extension (`fr-ctc-billing-mode`) that\ndescribes the nature of the supply and the payment context. The code is made up of\na letter prefix and a numeric suffix:\n\n| Prefix | Meaning |\n|--------|---------|\n| B | Goods (Biens) |\n| S | Services |\n| M | Mixed (goods and services that are not accessory to each other) |\n\n| Suffix | Meaning |\n|--------|---------|\n| 1 | Standard deposit invoice |\n| 2 | Already-paid invoice (payable amount = 0) |\n| 4 | Final invoice after one or more advance payments |\n| 5 | Subcontractor invoice (services only) |\n| 6 | Co-contractor invoice (services only) |\n| 7 | E-reporting invoice (VAT already collected) |\n\n## Identities\n\nA **SIREN** identity (9 digits) must be present on both the supplier and the customer\nfor B2B invoices. The **SIRET** (14 digits) is optional; if provided without a SIREN,\nthe addon will automatically derive the SIREN from the first nine digits of the SIRET.\n\nThe SIREN is automatically assigned the `legal` scope when no other identity on\nthe party already carries that scope.\n\nPrivate identifiers can be included using the `private-id` key; the addon will\nassign ISO scheme ID `0224` to these automatically.\n\n## Electronic Addresses (Inboxes)\n\nBoth the supplier and customer must have an electronic address for B2B invoices.\nAddresses using SIREN scheme `0225` must contain only alphanumeric characters\nand the symbols `+`, `-`, `_`, `/`. If the party has a SIREN identity and no inbox\ncarries a `peppol` key, the addon will assign the `peppol` key to the SIREN inbox\nautomatically.\n\n## Required Notes\n\nThree invoice-level notes with specific UNTDID text-subject codes are mandatory:\n\n| Code | Purpose |\n|------|---------|\n| `PMT` | Payment terms |\n| `PMD` | Payment means |\n| `AAB` | Buyer accounting reference (BAR) |\n\nThe BAR note must contain one of the following treatment values: `B2B`, `B2BINT`,\n`B2C`, `OUTOFSCOPE`, or `ARCHIVEONLY`.\n\n## Invoice Code\n\nThe invoice series and code must each be at most 35 characters and may only contain\nalphanumeric characters and the symbols `-`, `+`, `_`, `/`.\n\n## Currency Conversion\n\nWhen the invoice is issued in a currency other than EUR, the gobl.ubl conversion\nlibrary will automatically add EUR equivalents for the tax totals, satisfying the\nBR-FR-CO-12 requirement without any extra input from the user.",
    "fr": "Support pour le mandat de facturation électronique CTC (Contrôle Continu des\nTransactions) français Flux 2 B2B, issu de la réforme française de la facturation\nélectronique.\n\nCet addon étend le standard européen EN 16931 avec des règles spécifiques à la\nFrance pour les factures B2B réglementées, c'est-à-dire les factures échangées\nentre deux parties assujetties à la TVA en France. Il ne doit pas être utilisé pour\nles factures soumises uniquement à l'e-reporting (par exemple, B2C ou transactions\ntransfrontalières).\n\n## Cadre de facturation\n\nChaque facture doit comporter une extension **cadre de facturation**\n(`fr-ctc-billing-mode`) décrivant la nature de la prestation et le contexte de\npaiement. Le code est composé d'un préfixe lettré et d'un suffixe numérique :\n\n| Préfixe | Signification |\n|---------|---------------|\n| B | Biens |\n| S | Services |\n| M | Mixte (biens et services non accessoires les uns aux autres) |\n\n| Suffixe | Signification |\n|---------|---------------|\n| 1 | Facture de dépôt standard |\n| 2 | Facture déjà payée (montant exigible = 0) |\n| 4 | Facture définitive après un ou plusieurs acomptes |\n| 5 | Facture de sous-traitance (services uniquement) |\n| 6 | Facture de cotraitance (services uniquement) |\n| 7 | Facture e-reporting (TVA déjà collectée) |\n\n## Identifiants\n\nUn identifiant **SIREN** (9 chiffres) doit être présent chez le fournisseur et le\nclient pour les factures B2B. Le **SIRET** (14 chiffres) est facultatif ; s'il est\nfourni sans SIREN, l'addon dérive automatiquement le SIREN des neuf premiers chiffres\ndu SIRET.\n\nLe SIREN reçoit automatiquement la portée `legal` lorsqu'aucun autre identifiant de\nla partie ne porte déjà cette portée.\n\nLes identifiants privés peuvent être inclus avec la clé `private-id` ; l'addon leur\nattribue automatiquement l'identifiant de schéma ISO `0224`.\n\n## Adresses électroniques (boîtes de réception)\n\nLe fournisseur et le client doivent tous deux disposer d'une adresse électronique\npour les factures B2B. Les adresses utilisant le schéma SIREN `0225` ne doivent\ncontenir que des caractères alphanumériques et les symboles `+`, `-`, `_`, `/`. Si la\npartie possède un identifiant SIREN et qu'aucune boîte de réception ne porte la clé\n`peppol`, l'addon assigne automatiquement cette clé à la boîte SIREN.\n\n## Notes obligatoires\n\nTrois notes au niveau de la facture avec des codes objet de texte UNTDID spécifiques\nsont obligatoires :\n\n| Code | Objet |\n|------|-------|\n| `PMT` | Conditions de paiement |\n| `PMD` | Moyens de paiement |\n| `AAB` | Référence comptable acheteur (BAR) |\n\nLa note BAR doit contenir l'une des valeurs de traitement suivantes : `B2B`,\n`B2BINT`, `B2C`, `OUTOFSCOPE` ou `ARCHIVEONLY`.\n\n## Code de facture\n\nLa série et le code de la facture doivent chacun comporter au maximum 35 caractères\net ne peuvent contenir que des caractères alphanumériques et les symboles `-`, `+`,\n`_`, `/`.\n\n## Conversion de devises\n\nLorsque la facture est émise dans une devise autre que l'EUR, la bibliothèque de\nconversion gobl.ubl ajoute automatiquement les équivalents en EUR pour les totaux\nde TVA, satisfaisant l'exigence BR-FR-CO-12 sans intervention supplémentaire de\nl'utilisateur."
  },
  "sources": [
    {
      "title": {
        "en": "External Specifications",
        "fr": "Spécifications Externes"
      },
      "url": "https://www.impots.gouv.fr/specifications-externes-b2b"
    }
  ],
  "extensions": [
    {
      "key": "fr-ctc-billing-mode",
      "name": {
        "en": "Billing Mode",
        "fr": "Cadre de Facturation"
      },
      "desc": {
        "en": "Code used to describe the billing framework of the invoice. The billing mode\nindicates the nature of goods/services and the payment context.\n\nCode prefixes indicate the invoice nature:\n- \"B\": Goods invoice (Biens)\n- \"S\": Services invoice\n- \"M\": Mixed/dual invoice (goods and services that are not accessory to each other)\n\nThe numeric suffix indicates the payment type (1=deposit, 2=already paid,\n4=final after down payment, 5=subcontractor, 6=co-contractor, 7=e-reporting).",
        "fr": "Code utilisé pour décrire le cadre de facturation de la facture. Le mode de\nfacturation indique la nature des biens/services et le contexte de paiement.\n\nLes préfixes de code indiquent la nature de la facture :\n- \"B\" : Facture de biens\n- \"S\" : Facture de services\n- \"M\" : Facture mixte (biens et services qui ne sont pas accessoires l'un de l'autre)\n\nLe suffixe numérique indique le type de paiement (1=dépôt, 2=déjà payée,\n4=définitive après acompte, 5=sous-traitant, 6=cotraitant, 7=e-reporting)."
      },
      "values": [
        {
          "code": "B1",
          "name": {
            "en": "Goods - Deposit invoice",
            "fr": "Biens - Facture de dépôt"
          }
        },
        {
          "code": "B2",
          "name": {
            "en": "Goods - Already paid invoice",
            "fr": "Biens - Facture déjà payée"
          }
        },
        {
          "code": "B4",
          "name": {
            "en": "Goods - Final invoice (after down payment)",
            "fr": "Biens - Facture définitive (après acompte)"
          }
        },
        {
          "code": "B7",
          "name": {
            "en": "Goods - E-reporting (VAT already collected)",
            "fr": "Biens - E-reporting (TVA déjà collectée)"
          }
        },
        {
          "code": "S1",
          "name": {
            "en": "Services - Deposit invoice",
            "fr": "Services - Facture de dépôt"
          }
        },
        {
          "code": "S2",
          "name": {
            "en": "Services - Already paid invoice",
            "fr": "Services - Facture déjà payée"
          }
        },
        {
          "code": "S4",
          "name": {
            "en": "Services - Final invoice (after down payment)",
            "fr": "Services - Facture définitive (après acompte)"
          }
        },
        {
          "code": "S5",
          "name": {
            "en": "Services - Subcontractor invoice",
            "fr": "Services - Facture de sous-traitance"
          }
        },
        {
          "code": "S6",
          "name": {
            "en": "Services - Co-contractor invoice",
            "fr": "Services - Facture de cotraitance"
          }
        },
        {
          "code": "S7",
          "name": {
            "en": "Services - E-reporting (VAT already collected)",
            "fr": "Services - E-reporting (TVA déjà collectée)"
          }
        },
        {
          "code": "M1",
          "name": {
            "en": "Mixed - Deposit invoice",
            "fr": "Mixte - Facture de dépôt"
          }
        },
        {
          "code": "M2",
          "name": {
            "en": "Mixed - Already paid invoice",
            "fr": "Mixte - Facture déjà payée"
          }
        },
        {
          "code": "M4",
          "name": {
            "en": "Mixed - Final invoice (after down payment)",
            "fr": "Mixte - Facture définitive (après acompte)"
          }
        }
      ]
    }
  ],
  "scenarios": null,
  "corrections": null
}