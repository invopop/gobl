{
  "$schema": "https://gobl.org/draft-0/tax/addon-def",
  "key": "fr-ctc-flow2-v1",
  "requires": [
    "eu-en16931-v2017"
  ],
  "name": {
    "en": "France CTC Flow 2",
    "fr": "France CTC Flux 2"
  },
  "description": {
    "en": "Support for the French CTC (Continuous Transaction Controls) Flow 2 B2B\ne-invoicing mandate from the French electronic invoicing reform.\n\nThis addon extends the EN 16931 European standard with French-specific rules for\nregulated B2B invoices, that is, invoices exchanged between two parties registered\nfor VAT in France. It should not be used for invoices that are subject only to\ne-reporting (for example, B2C or cross-border transactions).\n\n## Billing Mode\n\nEvery invoice must carry a **billing mode** extension (`fr-ctc-billing-mode`) that\ndescribes the nature of the supply and the payment context. See the extension\ndefinition for the full list of accepted values.\n\n## Identities\n\nA **SIREN** identity (9 digits) must be present on both the supplier and the customer\nfor B2B invoices. The **SIRET** (14 digits) is optional; if provided without a SIREN,\nthe addon will automatically derive the SIREN from the first nine digits of the SIRET.\n\nNote that the SIREN is not currently derived from the party's VAT number; it must\nbe supplied explicitly as a separate identity. This may be added in a future release.\n\nThe SIREN is automatically assigned the `legal` scope when no other identity on\nthe party already carries that scope.\n\nPrivate identifiers can be included using the `private-id` key; the addon will\nassign ISO scheme ID `0224` to these automatically.\n\n## Electronic Addresses (Inboxes)\n\nBoth the supplier and customer must have an electronic address for B2B invoices.\nAddresses using SIREN scheme `0225` must contain only alphanumeric characters\nand the symbols `+`, `-`, `_`, `/`. If the party has a SIREN identity and no inbox\ncarries a `peppol` key, the addon will assign the `peppol` key to the SIREN inbox\nautomatically.\n\n## Required Notes\n\nEvery invoice must include at least three notes (BG-1) with the following\nUNTDID text-subject codes (BT-21). For the full mapping of GOBL note keys to\nUNTDID 4451 codes, see the EN 16931 addon (`eu-en16931-v2017`) documentation.\n\n- `PMT`: A mandatory mention of the 40 EUR flat-fee penalty for recovery costs\n  that applies to late payments (BT-22).\n- `PMD`: The late-payment penalty conditions that apply to each individual\n  company's payment terms (BT-22).\n- `AAB`: A mention of any early-payment discount offered, or an explicit\n  statement that no discount applies (BT-22).\n\nAn optional `BAR` note can be used to indicate the routing treatment of the\ninvoice. Its text must be one of: `B2B`, `B2BINT`, `B2C`, `OUTOFSCOPE`, or\n`ARCHIVEONLY`.\n\n## Invoice Code\n\nThe invoice series and code must each be at most 35 characters and may only contain\nalphanumeric characters and the symbols `-`, `+`, `_`, `/`.\n\n## Currency Conversion\n\nWhen the invoice is issued in a currency other than EUR, the gobl.ubl conversion\nlibrary will automatically add EUR equivalents for the tax totals, satisfying the\nBR-FR-CO-12 requirement without any extra input from the user.",
    "fr": "Support pour le mandat de facturation électronique CTC (Contrôle Continu des\nTransactions) français Flux 2 B2B, issu de la réforme française de la facturation\nélectronique.\n\nCet addon étend le standard européen EN 16931 avec des règles spécifiques à la\nFrance pour les factures B2B réglementées, c'est-à-dire les factures échangées\nentre deux parties assujetties à la TVA en France. Il ne doit pas être utilisé pour\nles factures soumises uniquement à l'e-reporting (par exemple, B2C ou transactions\ntransfrontalières).\n\n## Cadre de facturation\n\nChaque facture doit comporter une extension **cadre de facturation**\n(`fr-ctc-billing-mode`) décrivant la nature de la prestation et le contexte de\npaiement. Consultez la définition de l'extension pour la liste complète des valeurs\nacceptées.\n\n## Identifiants\n\nUn identifiant **SIREN** (9 chiffres) doit être présent chez le fournisseur et le\nclient pour les factures B2B. Le **SIRET** (14 chiffres) est facultatif ; s'il est\nfourni sans SIREN, l'addon dérive automatiquement le SIREN des neuf premiers chiffres\ndu SIRET.\n\nLe SIREN n'est pas actuellement dérivé du numéro de TVA de la partie ; il doit être\nfourni explicitement comme identifiant séparé. Cette fonctionnalité pourra être\najoutée dans une version future.\n\nLe SIREN reçoit automatiquement la portée `legal` lorsqu'aucun autre identifiant de\nla partie ne porte déjà cette portée.\n\nLes identifiants privés peuvent être inclus avec la clé `private-id` ; l'addon leur\nattribue automatiquement l'identifiant de schéma ISO `0224`.\n\n## Adresses électroniques (boîtes de réception)\n\nLe fournisseur et le client doivent tous deux disposer d'une adresse électronique\npour les factures B2B. Les adresses utilisant le schéma SIREN `0225` ne doivent\ncontenir que des caractères alphanumériques et les symboles `+`, `-`, `_`, `/`. Si la\npartie possède un identifiant SIREN et qu'aucune boîte de réception ne porte la clé\n`peppol`, l'addon assigne automatiquement cette clé à la boîte SIREN.\n\n## Notes obligatoires\n\nToute facture doit comporter au moins trois notes (BG-1) avec les codes objet de\ntexte UNTDID (BT-21) suivants. Pour la correspondance complète entre les clés de\nnotes GOBL et les codes UNTDID 4451, consultez la documentation de l'addon\nEN 16931 (`eu-en16931-v2017`).\n\n- `PMT` : Mention obligatoire de l'indemnité forfaitaire de 40 EUR pour frais de\n  recouvrement applicable en cas de retard de paiement (BT-22).\n- `PMD` : Mention des pénalités de retard correspondant aux conditions de paiement\n  propres à chaque entreprise (BT-22).\n- `AAB` : Mention d'escompte proposé ou mention explicite de l'absence d'escompte\n  (BT-22).\n\nUne note `BAR` facultative peut être utilisée pour indiquer le traitement de\nroutage de la facture. Son texte doit être l'une des valeurs suivantes : `B2B`,\n`B2BINT`, `B2C`, `OUTOFSCOPE` ou `ARCHIVEONLY`.\n\n## Code de facture\n\nLa série et le code de la facture doivent chacun comporter au maximum 35 caractères\net ne peuvent contenir que des caractères alphanumériques et les symboles `-`, `+`,\n`_`, `/`.\n\n## Conversion de devises\n\nLorsque la facture est émise dans une devise autre que l'EUR, la bibliothèque de\nconversion gobl.ubl ajoute automatiquement les équivalents en EUR pour les totaux\nde TVA, satisfaisant l'exigence BR-FR-CO-12 sans intervention supplémentaire de\nl'utilisateur."
  },
  "sources": [
    {
      "title": {
        "en": "External Specifications",
        "fr": "Spécifications Externes"
      },
      "url": "https://www.impots.gouv.fr/specifications-externes-b2b"
    }
  ],
  "extensions": [
    {
      "key": "fr-ctc-billing-mode",
      "name": {
        "en": "Billing Mode",
        "fr": "Cadre de Facturation"
      },
      "desc": {
        "en": "Code used to describe the billing framework of the invoice. The billing mode\nindicates the nature of goods/services and the payment context.\n\nCode prefixes indicate the invoice nature:\n- \"B\": Goods invoice (Biens)\n- \"S\": Services invoice\n- \"M\": Mixed/dual invoice (goods and services that are not accessory to each other)\n\nThe numeric suffix indicates the payment type (1=deposit, 2=already paid,\n4=final after down payment, 5=subcontractor, 6=co-contractor, 7=e-reporting).\n\nThe value is currently trusted as provided and is not normalised from other invoice\nfields. Automatic inference from document type and payment context may be added in\na future release.",
        "fr": "Code utilisé pour décrire le cadre de facturation de la facture. Le mode de\nfacturation indique la nature des biens/services et le contexte de paiement.\n\nLes préfixes de code indiquent la nature de la facture :\n- \"B\" : Facture de biens\n- \"S\" : Facture de services\n- \"M\" : Facture mixte (biens et services qui ne sont pas accessoires l'un de l'autre)\n\nLe suffixe numérique indique le type de paiement (1=dépôt, 2=déjà payée,\n4=définitive après acompte, 5=sous-traitant, 6=cotraitant, 7=e-reporting).\n\nLa valeur est actuellement utilisée telle quelle et n'est pas normalisée à partir\ndes autres champs de la facture. Une inférence automatique à partir du type de\ndocument et du contexte de paiement pourra être ajoutée dans une version future."
      },
      "values": [
        {
          "code": "B1",
          "name": {
            "en": "Goods - Deposit invoice",
            "fr": "Biens - Facture de dépôt"
          }
        },
        {
          "code": "B2",
          "name": {
            "en": "Goods - Already paid invoice",
            "fr": "Biens - Facture déjà payée"
          }
        },
        {
          "code": "B4",
          "name": {
            "en": "Goods - Final invoice (after down payment)",
            "fr": "Biens - Facture définitive (après acompte)"
          }
        },
        {
          "code": "B7",
          "name": {
            "en": "Goods - E-reporting (VAT already collected)",
            "fr": "Biens - E-reporting (TVA déjà collectée)"
          }
        },
        {
          "code": "S1",
          "name": {
            "en": "Services - Deposit invoice",
            "fr": "Services - Facture de dépôt"
          }
        },
        {
          "code": "S2",
          "name": {
            "en": "Services - Already paid invoice",
            "fr": "Services - Facture déjà payée"
          }
        },
        {
          "code": "S4",
          "name": {
            "en": "Services - Final invoice (after down payment)",
            "fr": "Services - Facture définitive (après acompte)"
          }
        },
        {
          "code": "S5",
          "name": {
            "en": "Services - Subcontractor invoice",
            "fr": "Services - Facture de sous-traitance"
          }
        },
        {
          "code": "S6",
          "name": {
            "en": "Services - Co-contractor invoice",
            "fr": "Services - Facture de cotraitance"
          }
        },
        {
          "code": "S7",
          "name": {
            "en": "Services - E-reporting (VAT already collected)",
            "fr": "Services - E-reporting (TVA déjà collectée)"
          }
        },
        {
          "code": "M1",
          "name": {
            "en": "Mixed - Deposit invoice",
            "fr": "Mixte - Facture de dépôt"
          }
        },
        {
          "code": "M2",
          "name": {
            "en": "Mixed - Already paid invoice",
            "fr": "Mixte - Facture déjà payée"
          }
        },
        {
          "code": "M4",
          "name": {
            "en": "Mixed - Final invoice (after down payment)",
            "fr": "Mixte - Facture définitive (après acompte)"
          }
        }
      ]
    }
  ],
  "scenarios": null,
  "corrections": null
}